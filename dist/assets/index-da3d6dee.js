(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerpolicy&&(d.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?d.credentials="include":a.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(a){if(a.ep)return;a.ep=!0;const d=r(a);fetch(a.href,d)}})();const bt="modulepreload",Mt=function(e){return"/"+e},Je={},kt=function(i,r,s){if(!r||r.length===0)return i();const a=document.getElementsByTagName("link");return Promise.all(r.map(d=>{if(d=Mt(d),d in Je)return;Je[d]=!0;const h=d.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(!!s)for(let _=a.length-1;_>=0;_--){const n=a[_];if(n.href===d&&(!h||n.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${m}`))return;const F=document.createElement("link");if(F.rel=h?"stylesheet":bt,h||(F.as="script",F.crossOrigin=""),F.href=d,document.head.appendChild(F),h)return new Promise((_,n)=>{F.addEventListener("load",_),F.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${d}`)))})})).then(()=>i())},nt=(e,i)=>{i=et(i),e!==void 0?(e=et(e),e.appendChild(i)):document.body.appendChild(i)},et=e=>{if(typeof e=="string"){const i=document.querySelector(e);if(!i)throw new Error(`could not find the element with the selector: ${e}`);return i}return e},st=e=>{if(typeof e=="string"){const i=document.querySelector(e);if(!i)throw new Error(`could not find the element with the selector: ${e}`);return i}return e};var ot=({parent:e,mode:i="2d",width:r,height:s,pixelRatio:a=1,scaleContext:d=!0,attributes:h})=>{if(a<=0)throw new Error("pixelRatio must be great than 0");const m=document.createElement("canvas");return nt(e,m),ne({canvas:m,mode:i,width:r,height:s,pixelRatio:a,scaleContext:d,attributes:h})},ne=({canvas:e,mode:i,width:r,height:s,pixelRatio:a=1,scaleContext:d=!0,attributes:h})=>{e.width=r*a,e.height=s*a,e.style.width=`${r}px`,e.style.height=`${s}px`;let m,b;if(i==="2d"){if(m=e.getContext("2d",h),!m)throw new Error("2d context cannot be created");d&&m.scale(a,a)}else if(i==="webgl"){if(m=e.getContext("webgl",h),b=m,!m)throw new Error("webgl context cannot be created");d?b.viewport(0,0,r*a,s*a):b.viewport(0,0,r,s)}else throw new Error(`${i} is not supported`);if(m)return{canvas:e,context:m,gl:b,width:r,height:s};throw new Error(`${i} context could not be created`)},di=({parent:e,canvas:i,width:r,height:s,pixelRatio:a=1})=>{if(a<=0)throw new Error("pixelRatio must be great than 0");return nt(e,i),i.width=r*a,i.height=s*a,i.style.width=`${r}px`,i.style.height=`${s}px`,{canvas:i,width:r,height:s,pixelRatio:a}};function _t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ve={},Ct={get exports(){return Ve},set exports(e){Ve=e}};(function(e){var i=(()=>{var r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,d=Object.prototype.hasOwnProperty,h=Math.pow,m=(t,o)=>{for(var l in o)r(t,l,{get:o[l],enumerable:!0})},b=(t,o,l,u)=>{if(o&&typeof o=="object"||typeof o=="function")for(let c of a(o))!d.call(t,c)&&c!==l&&r(t,c,{get:()=>o[c],enumerable:!(u=s(o,c))||u.enumerable});return t},F=t=>b(r({},"__esModule",{value:!0}),t),_=(t,o,l)=>{if(!o.has(t))throw TypeError("Cannot "+l)},n=(t,o,l)=>(_(t,o,"read from private field"),l?l.call(t):o.get(t)),w=(t,o,l)=>{if(o.has(t))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(t):o.set(t,l)},C=(t,o,l,u)=>(_(t,o,"write to private field"),u?u.call(t,l):o.set(t,l),l),M=(t,o,l)=>(_(t,o,"access private method"),l),v={};m(v,{default:()=>yt});var f=class{constructor(t){this.value=t}},g=class{constructor(t){this.value=t}},y=class{constructor(){this.pos=0,this.helper=new Uint8Array(8),this.helperView=new DataView(this.helper.buffer),this.offsets=new WeakMap,this.dataOffsets=new WeakMap}writeFloat32(t){this.helperView.setFloat32(0,t,!1),this.write(this.helper.subarray(0,4))}writeFloat64(t){this.helperView.setFloat64(0,t,!1),this.write(this.helper)}writeUnsignedInt(t,o=k(t)){let l=0;switch(o){case 6:this.helperView.setUint8(l++,t/h(2,40)|0);case 5:this.helperView.setUint8(l++,t/h(2,32)|0);case 4:this.helperView.setUint8(l++,t>>24);case 3:this.helperView.setUint8(l++,t>>16);case 2:this.helperView.setUint8(l++,t>>8);case 1:this.helperView.setUint8(l++,t);break;default:throw new Error("Bad UINT size "+o)}this.write(this.helper.subarray(0,l))}writeEBMLVarInt(t,o=Z(t)){let l=0;switch(o){case 1:this.helperView.setUint8(l++,1<<7|t);break;case 2:this.helperView.setUint8(l++,1<<6|t>>8),this.helperView.setUint8(l++,t);break;case 3:this.helperView.setUint8(l++,1<<5|t>>16),this.helperView.setUint8(l++,t>>8),this.helperView.setUint8(l++,t);break;case 4:this.helperView.setUint8(l++,1<<4|t>>24),this.helperView.setUint8(l++,t>>16),this.helperView.setUint8(l++,t>>8),this.helperView.setUint8(l++,t);break;case 5:this.helperView.setUint8(l++,1<<3|t/h(2,32)&7),this.helperView.setUint8(l++,t>>24),this.helperView.setUint8(l++,t>>16),this.helperView.setUint8(l++,t>>8),this.helperView.setUint8(l++,t);break;case 6:this.helperView.setUint8(l++,1<<2|t/h(2,40)&3),this.helperView.setUint8(l++,t/h(2,32)|0),this.helperView.setUint8(l++,t>>24),this.helperView.setUint8(l++,t>>16),this.helperView.setUint8(l++,t>>8),this.helperView.setUint8(l++,t);break;default:throw new Error("Bad EBML VINT size "+o)}this.write(this.helper.subarray(0,l))}writeString(t){this.write(new Uint8Array(t.split("").map(o=>o.charCodeAt(0))))}writeEBML(t){var o,l;if(t instanceof Uint8Array)this.write(t);else if(Array.isArray(t))for(let u of t)this.writeEBML(u);else if(this.offsets.set(t,this.pos),this.writeUnsignedInt(t.id),Array.isArray(t.data)){let u=this.pos,c=(o=t.size)!=null?o:4;this.seek(this.pos+c);let E=this.pos;this.dataOffsets.set(t,E),this.writeEBML(t.data);let I=this.pos-E,S=this.pos;this.seek(u),this.writeEBMLVarInt(I,c),this.seek(S)}else if(typeof t.data=="number"){let u=(l=t.size)!=null?l:k(t.data);this.writeEBMLVarInt(u),this.writeUnsignedInt(t.data,u)}else typeof t.data=="string"?(this.writeEBMLVarInt(t.data.length),this.writeString(t.data)):t.data instanceof Uint8Array?(this.writeEBMLVarInt(t.data.byteLength,t.size),this.write(t.data)):t.data instanceof f?(this.writeEBMLVarInt(4),this.writeFloat32(t.data.value)):t.data instanceof g&&(this.writeEBMLVarInt(8),this.writeFloat64(t.data.value))}},k=t=>t<1<<8?1:t<1<<16?2:t<1<<24?3:t<h(2,32)?4:t<h(2,40)?5:6,Z=t=>{if(t<(1<<7)-1)return 1;if(t<(1<<14)-1)return 2;if(t<(1<<21)-1)return 3;if(t<(1<<28)-1)return 4;if(t<h(2,35)-1)return 5;if(t<h(2,42)-1)return 6;throw new Error("EBML VINT size not supported "+t)},$e=class extends y{constructor(){super(),this.buffer=new ArrayBuffer(h(2,16)),this.bytes=new Uint8Array(this.buffer)}ensureSize(t){let o=this.buffer.byteLength;for(;o<t;)o*=2;if(o===this.buffer.byteLength)return;let l=new ArrayBuffer(o),u=new Uint8Array(l);u.set(this.bytes,0),this.buffer=l,this.bytes=u}write(t){this.ensureSize(this.pos+t.byteLength),this.bytes.set(t,this.pos),this.pos+=t.byteLength}seek(t){this.pos=t}finalize(){return this.ensureSize(this.pos),this.buffer.slice(0,this.pos)}},A=h(2,24),ct=2,xe=class extends y{constructor(t){super(),this.chunks=[],this.stream=t}write(t){this.writeDataIntoChunks(t,this.pos),this.flushChunks(),this.pos+=t.byteLength}writeDataIntoChunks(t,o){let l=this.chunks.findIndex(S=>S.start<=o&&o<S.start+A);l===-1&&(l=this.createChunk(o));let u=this.chunks[l],c=o-u.start,E=t.subarray(0,Math.min(A-c,t.byteLength));u.data.set(E,c);let I={start:c,end:c+E.byteLength};if(ut(u,I),u.written[0].start===0&&u.written[0].end===A&&(u.shouldFlush=!0),this.chunks.length>ct){for(let S=0;S<this.chunks.length-1;S++)this.chunks[S].shouldFlush=!0;this.flushChunks()}E.byteLength<t.byteLength&&this.writeDataIntoChunks(t.subarray(E.byteLength),o+E.byteLength)}createChunk(t){let l={start:Math.floor(t/A)*A,data:new Uint8Array(A),written:[],shouldFlush:!1};return this.chunks.push(l),this.chunks.sort((u,c)=>u.start-c.start),this.chunks.indexOf(l)}flushChunks(t=!1){for(let o=0;o<this.chunks.length;o++){let l=this.chunks[o];if(!(!l.shouldFlush&&!t)){for(let u of l.written)this.stream.write({type:"write",data:l.data.subarray(u.start,u.end),position:l.start+u.start});this.chunks.splice(o--,1)}}}seek(t){this.pos=t}finalize(){this.flushChunks(!0)}},ut=(t,o)=>{let l=0,u=t.written.length-1,c=-1;for(;l<=u;){let E=Math.floor(l+(u-l+1)/2);t.written[E].start<=o.start?(l=E+1,c=E):u=E-1}for(t.written.splice(c+1,0,o),(c===-1||t.written[c].end<o.start)&&c++;c<t.written.length-1&&t.written[c].end>=t.written[c+1].start;)t.written[c].end=Math.max(t.written[c].end,t.written[c+1].end),t.written.splice(c+1,1)},G=1,me=2,mt=1,wt=2,we=h(2,15),pe=h(2,12),De="https://github.com/Vanilagy/webm-muxer",Ae=6,Oe=5,p,T,X,Q,P,J,O,N,ee,te,H,U,K,ie,B,R,se,oe,re,le,ye,Ne,ve,He,ge,Ke,be,qe,Me,je,ke,Ye,_e,Ze,x,q,Ce,Ge,Ee,Xe,de,Fe,z,D,he,Te,Se,Qe,fe,Ie,ce,Le,pt=class{constructor(t){w(this,ye),w(this,ve),w(this,ge),w(this,be),w(this,Me),w(this,ke),w(this,_e),w(this,x),w(this,Ce),w(this,Ee),w(this,de),w(this,z),w(this,he),w(this,Se),w(this,fe),w(this,ce),w(this,p,void 0),w(this,T,void 0),w(this,X,void 0),w(this,Q,void 0),w(this,P,void 0),w(this,J,void 0),w(this,O,void 0),w(this,N,void 0),w(this,ee,void 0),w(this,te,void 0),w(this,H,void 0),w(this,U,void 0),w(this,K,void 0),w(this,ie,0),w(this,B,[]),w(this,R,[]),w(this,se,0),w(this,oe,0),w(this,re,void 0),w(this,le,!1),C(this,T,t),t.target==="buffer"?C(this,p,new $e):C(this,p,new xe(t.target)),M(this,ye,Ne).call(this)}addVideoChunk(t,o,l){let u=new Uint8Array(t.byteLength);t.copyTo(u),this.addVideoChunkRaw(u,t.type,l??t.timestamp,o)}addVideoChunkRaw(t,o,l,u){if(M(this,ce,Le).call(this),!n(this,T).video)throw new Error("No video track declared.");u&&M(this,Ce,Ge).call(this,u);let c=M(this,de,Fe).call(this,t,o,l,G);for(n(this,T).video.codec==="V_VP9"&&M(this,Ee,Xe).call(this,c),C(this,se,c.timestamp);n(this,R).length>0&&n(this,R)[0].timestamp<=c.timestamp;){let E=n(this,R).shift();M(this,z,D).call(this,E)}!n(this,T).audio||c.timestamp<=n(this,oe)?M(this,z,D).call(this,c):n(this,B).push(c)}addAudioChunk(t,o,l){let u=new Uint8Array(t.byteLength);t.copyTo(u),this.addAudioChunkRaw(u,t.type,l??t.timestamp,o)}addAudioChunkRaw(t,o,l,u){if(M(this,ce,Le).call(this),!n(this,T).audio)throw new Error("No audio track declared.");let c=M(this,de,Fe).call(this,t,o,l,me);for(C(this,oe,c.timestamp);n(this,B).length>0&&n(this,B)[0].timestamp<=c.timestamp;){let E=n(this,B).shift();M(this,z,D).call(this,E)}!n(this,T).video||c.timestamp<=n(this,se)?M(this,z,D).call(this,c):n(this,R).push(c),u!=null&&u.decoderConfig&&M(this,he,Te).call(this,n(this,te),u.decoderConfig.description)}finalize(){for(;n(this,B).length>0;)M(this,z,D).call(this,n(this,B).shift());for(;n(this,R).length>0;)M(this,z,D).call(this,n(this,R).shift());M(this,fe,Ie).call(this),n(this,p).writeEBML(n(this,H));let t=n(this,p).pos,o=n(this,p).pos-n(this,x,q);return n(this,p).seek(n(this,p).offsets.get(n(this,X))+4),n(this,p).writeEBMLVarInt(o,Ae),n(this,O).data=new g(n(this,ie)),n(this,p).seek(n(this,p).offsets.get(n(this,O))),n(this,p).writeEBML(n(this,O)),n(this,P).data[0].data[1].data=n(this,p).offsets.get(n(this,H))-n(this,x,q),n(this,P).data[1].data[1].data=n(this,p).offsets.get(n(this,Q))-n(this,x,q),n(this,P).data[2].data[1].data=n(this,p).offsets.get(n(this,J))-n(this,x,q),n(this,p).seek(n(this,p).offsets.get(n(this,P))),n(this,p).writeEBML(n(this,P)),n(this,p).seek(t),C(this,le,!0),n(this,p)instanceof $e?n(this,p).finalize():(n(this,p)instanceof xe&&n(this,p).finalize(),null)}};p=new WeakMap,T=new WeakMap,X=new WeakMap,Q=new WeakMap,P=new WeakMap,J=new WeakMap,O=new WeakMap,N=new WeakMap,ee=new WeakMap,te=new WeakMap,H=new WeakMap,U=new WeakMap,K=new WeakMap,ie=new WeakMap,B=new WeakMap,R=new WeakMap,se=new WeakMap,oe=new WeakMap,re=new WeakMap,le=new WeakMap,ye=new WeakSet,Ne=function(){M(this,ve,He).call(this),M(this,ge,Ke).call(this),M(this,be,qe).call(this),M(this,Me,je).call(this),M(this,ke,Ye).call(this),M(this,_e,Ze).call(this)},ve=new WeakSet,He=function(){let t={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]};n(this,p).writeEBML(t)},ge=new WeakSet,Ke=function(){const t=new Uint8Array([28,83,187,107]),o=new Uint8Array([21,73,169,102]),l=new Uint8Array([22,84,174,107]);C(this,P,{id:290298740,data:[{id:19899,data:[{id:21419,data:t},{id:21420,size:5,data:0}]},{id:19899,data:[{id:21419,data:o},{id:21420,size:5,data:0}]},{id:19899,data:[{id:21419,data:l},{id:21420,size:5,data:0}]}]})},be=new WeakSet,qe=function(){let t={id:17545,data:new g(0)};C(this,O,t),C(this,Q,{id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:De},{id:22337,data:De},t]})},Me=new WeakSet,je=function(){let t={id:374648427,data:[]};if(C(this,J,t),n(this,T).video){C(this,ee,{id:236,size:4,data:new Uint8Array(pe)});let o={id:21936,data:[{id:21937,data:2},{id:21946,data:2},{id:21947,data:2},{id:21945,data:0}]};C(this,N,o),t.data.push({id:174,data:[{id:215,data:G},{id:29637,data:G},{id:131,data:mt},{id:134,data:n(this,T).video.codec},n(this,ee),n(this,T).video.frameRate?{id:2352003,data:1e9/n(this,T).video.frameRate}:null,{id:224,data:[{id:176,data:n(this,T).video.width},{id:186,data:n(this,T).video.height},o]}].filter(Boolean)})}n(this,T).audio&&(C(this,te,{id:236,size:4,data:new Uint8Array(pe)}),t.data.push({id:174,data:[{id:215,data:me},{id:29637,data:me},{id:131,data:wt},{id:134,data:n(this,T).audio.codec},n(this,te),{id:225,data:[{id:181,data:new f(n(this,T).audio.sampleRate)},{id:159,data:n(this,T).audio.numberOfChannels},n(this,T).audio.bitDepth?{id:25188,data:n(this,T).audio.bitDepth}:null].filter(Boolean)}]}))},ke=new WeakSet,Ye=function(){let t={id:408125543,size:Ae,data:[n(this,P),n(this,Q),n(this,J)]};C(this,X,t),n(this,p).writeEBML(t)},_e=new WeakSet,Ze=function(){C(this,H,{id:475249515,data:[]})},x=new WeakSet,q=function(){return n(this,p).dataOffsets.get(n(this,X))},Ce=new WeakSet,Ge=function(t){if(t.decoderConfig){if(t.decoderConfig.colorSpace){let o=t.decoderConfig.colorSpace;C(this,re,o),n(this,N).data=[{id:21937,data:{rgb:1,bt709:1,bt470bg:5,smpte170m:6}[o.matrix]},{id:21946,data:{bt709:1,smpte170m:6,"iec61966-2-1":13}[o.transfer]},{id:21947,data:{bt709:1,bt470bg:5,smpte170m:6}[o.primaries]},{id:21945,data:[1,2][Number(o.fullRange)]}];let l=n(this,p).pos;n(this,p).seek(n(this,p).offsets.get(n(this,N))),n(this,p).writeEBML(n(this,N)),n(this,p).seek(l)}t.decoderConfig.description&&M(this,he,Te).call(this,n(this,ee),t.decoderConfig.description)}},Ee=new WeakSet,Xe=function(t){if(t.type!=="key"||!n(this,re))return;let o=0;if(j(t.data,0,2)!==2)return;o+=2;let l=(j(t.data,o+1,o+2)<<1)+j(t.data,o+0,o+1);o+=2,l===3&&o++;let u=j(t.data,o+0,o+1);if(o++,u)return;let c=j(t.data,o+0,o+1);if(o++,c!==0)return;o+=2;let E=j(t.data,o+0,o+24);if(o+=24,E!==4817730)return;l>=2&&o++;let I={rgb:7,bt709:2,bt470bg:1,smpte170m:3}[n(this,re).matrix];vt(t.data,o+0,o+3,I)},de=new WeakSet,Fe=function(t,o,l,u){return{data:t,type:o,timestamp:l,trackNumber:u}},z=new WeakSet,D=function(t){let o=Math.floor(t.timestamp/1e3);if(t.type!=="key"&&o-n(this,K)>=we)throw new Error(`Current Matroska cluster exceeded its maximum allowed length of ${we} milliseconds. In order to produce a correct WebM file, you must pass in a video key frame at least every ${we} milliseconds.`);let u=(t.trackNumber===G||!n(this,T).video)&&t.type==="key"&&o-n(this,K)>=1e3;(!n(this,U)||u)&&M(this,Se,Qe).call(this,o);let c=new Uint8Array(4),E=new DataView(c.buffer);E.setUint8(0,128|t.trackNumber),E.setUint16(1,o-n(this,K),!1),E.setUint8(3,Number(t.type==="key")<<7);let I={id:163,data:[c,t.data]};n(this,p).writeEBML(I),C(this,ie,Math.max(n(this,ie),o))},he=new WeakSet,Te=function(t,o){let l=n(this,p).pos;n(this,p).seek(n(this,p).offsets.get(t)),t=[{id:25506,size:4,data:new Uint8Array(o)},{id:236,size:4,data:new Uint8Array(pe-2-4-o.byteLength)}],n(this,p).writeEBML(t),n(this,p).seek(l)},Se=new WeakSet,Qe=function(t){n(this,U)&&M(this,fe,Ie).call(this),C(this,U,{id:524531317,size:Oe,data:[{id:231,data:t}]}),n(this,p).writeEBML(n(this,U)),C(this,K,t);let o=n(this,p).offsets.get(n(this,U))-n(this,x,q);n(this,H).data.push({id:187,data:[{id:179,data:t},{id:183,data:[{id:247,data:G},{id:241,data:o}]}]})},fe=new WeakSet,Ie=function(){let t=n(this,p).pos-n(this,p).dataOffsets.get(n(this,U)),o=n(this,p).pos;n(this,p).seek(n(this,p).offsets.get(n(this,U))+4),n(this,p).writeEBMLVarInt(t,Oe),n(this,p).seek(o)},ce=new WeakSet,Le=function(){if(n(this,le))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")};var yt=pt,j=(t,o,l)=>{let u=0;for(let c=o;c<l;c++){let E=Math.floor(c/8),I=t[E],S=7-(c&7),gt=(I&1<<S)>>S;u<<=1,u|=gt}return u},vt=(t,o,l,u)=>{for(let c=o;c<l;c++){let E=Math.floor(c/8),I=t[E],S=7-(c&7);I&=~(1<<S),I|=(u&1<<l-c-1)>>l-c-1<<S,t[E]=I}};return F(v)})();i=i.default,e.exports=i})(Ct);const Et=_t(Ve);var tt=({settings:e,props:i})=>{const{duration:r}=e;i.playhead=r!==1/0?i.time/r:0},Ft=({settings:e,states:i,props:r})=>{let{duration:s,playFps:a,exportFps:d,totalFrames:h}=e;const m=i.savingFrames?d:a;i.savingFrames&&(h=Math.floor(d*s/1e3)),s!==1/0?m!==null?r.frame=Math.floor(r.playhead*h):r.frame+=1:m!==null?r.frame=Math.floor(r.time*m/1e3):r.frame+=1},it=({states:e,props:i})=>{e.lastTimestamp=e.frameInterval?e.timestamp-i.deltaTime%e.frameInterval:e.timestamp},Pe=({settings:e,states:i,props:r})=>{const{playFps:s,exportFps:a}=e,d=i.savingFrames?a:s;i.startTime=i.timestamp,r.time=0,r.playhead=0,r.frame=s?0:-1,i.lastTimestamp=i.startTime-(d?1e3/d:0),i.timeResetted=!1},Tt=({main:e})=>{const i={title:"Sketch",background:"#333",parent:"body",canvas:null,dimensions:[window.innerWidth,window.innerHeight],pixelRatio:1,centered:!0,scaleContext:!0,pixelated:!1,animate:!0,playFps:null,exportFps:60,duration:1/0,totalFrames:1/0,exportTotalFrames:1/0,filename:"",prefix:"",suffix:"",frameFormat:"png",framesFormat:"webm",hotkeys:!0,mode:"2d"},r=Object.assign({},i,e);for(const[s,a]of Object.entries(r))a===void 0&&(r[s]=i[s]);if(Object.values(r).some(s=>s===void 0))throw new Error("settings object cannot have undefined values");return document.title=r.title,document.body.style.background=r.background,r.playFps!==null&&(r.playFps=Math.max(Math.floor(r.playFps),1)),r.exportFps=Math.max(Math.floor(r.exportFps),1),r.playFps!==null&&r.duration!==1/0&&(r.totalFrames=Math.floor(r.duration*r.playFps/1e3)),r.exportFps!==null&&r.duration!==1/0&&(r.exportTotalFrames=Math.floor(r.exportFps*r.duration/1e3)),r},rt=e=>{let i,r,[s,a]=e.dimensions;const d=Math.max(e.pixelRatio,1),h="2d";if(e.canvas===void 0||e.canvas===null)({canvas:i,context:r,width:s,height:a}=ot({parent:e.parent,mode:h,width:s,height:a,pixelRatio:d,scaleContext:e.scaleContext,attributes:e.attributes}));else{if(e.canvas.nodeName.toLowerCase()!=="canvas")throw new Error("provided canvas must be an HTMLCanvasElement");i=e.canvas,e.parent&&st(e.parent).appendChild(i),{context:r,width:s,height:a}=ne({canvas:i,mode:h,width:e.dimensions?e.dimensions[0]:i.width,height:e.dimensions?e.dimensions[1]:i.height,pixelRatio:d,scaleContext:e.scaleContext,attributes:e.attributes})}if(e.centered===!0){const m=i.parentElement;m.style.width="100vw",m.style.height="100vh",m.style.display="flex",m.style.justifyContent="center",m.style.alignItems="center",e.scaleContext}else i.style.width=100+"%",i.style.height=100+"%",i.style.maxWidth=`${e.dimensions[0]}px`,i.style.maxHeight=`${e.dimensions[1]}px`;return{canvas:i,context:r,width:s,height:a,pixelRatio:d}},St=e=>{let i,r,s,[a,d]=e.dimensions;const h=Math.max(e.pixelRatio,1),m="webgl";if(e.canvas===void 0||e.canvas===null)({canvas:i,context:r,gl:s,width:a,height:d}=ot({parent:e.parent,mode:m,width:a,height:d,pixelRatio:h,scaleContext:e.scaleContext,attributes:e.attributes}));else{if(e.canvas.nodeName.toLowerCase()!=="canvas")throw new Error("provided canvas must be an HTMLCanvasElement");i=e.canvas,e.parent&&st(e.parent).appendChild(i),{context:r,gl:s,width:a,height:d}=ne({canvas:i,mode:m,width:e.dimensions?e.dimensions[0]:i.width,height:e.dimensions?e.dimensions[1]:i.height,pixelRatio:h,scaleContext:e.scaleContext,attributes:e.attributes})}if(e.centered===!0){const b=i.parentElement;b.style.width="100vw",b.style.height="100vh",b.style.display="flex",b.style.justifyContent="center",b.style.alignItems="center",e.scaleContext}else i.style.width=100+"%",i.style.height=100+"%",i.style.maxWidth=`${e.dimensions[0]}px`,i.style.maxHeight=`${e.dimensions[1]}px`;return{canvas:i,context:r,gl:s,width:a,height:d,pixelRatio:h}},It=async e=>e.mode==="2d"?rt(e):e.mode==="webgl"?St(e):e.mode==="ogl"?(await kt(()=>import("./ogl-SXYU76IS-d5410293.js"),[])).createOglCanvas(e):rt(e),lt=({filename:e,prefix:i="",suffix:r=""})=>e===void 0||e===""?`${i}${Lt(new Date)}${r}`:e,Lt=e=>{const i=e.getTimezoneOffset();e.setMinutes(e.getMinutes()-i);const r=e.toISOString(),[s,a,d,h,m,b,F]=r.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);return`${a}.${d}.${h}-${m}.${b}.${F}`},Pt=({canvas:e,states:i,settings:r})=>{let{filename:s,prefix:a,suffix:d,frameFormat:h}=r;h==="jpg"&&(h="jpeg");const m=e.toDataURL(`image/${h}`),b=document.createElement("a");b.download=`${lt({filename:s,prefix:a,suffix:d})}.${h}`,b.href=m,b.click(),i.savingFrame=!1,i.playMode="play"},Ut=async({settings:e,states:i})=>{const{canvas:r,context:s,width:a,height:d,pixelRatio:h,gl:m,oglContext:b,oglRenderer:F}=await It(e),{exportFrame:_,update:n,togglePlay:w}=Wt({canvas:r,settings:e,states:i}),C={canvas:r,width:a,height:d,pixelRatio:h,playhead:0,frame:0,time:0,deltaTime:0,duration:e.duration,totalFrames:e.totalFrames,exportFrame:_,togglePlay:w,update:n};let M;return e.mode==="2d"?M={...C,context:s}:e.mode==="ogl"?M={...C,oglContext:b,oglRenderer:F}:M={...C,gl:m},M},Wt=({canvas:e,settings:i,states:r})=>({exportFrame:Vt({canvas:e,settings:i,states:r}),update:Rt({canvas:e,prevSettings:i,resizeCanvas:ne}),togglePlay:Bt({states:r})}),Vt=({canvas:e,settings:i,states:r})=>()=>{r.savingFrame=!0,r.playMode="record",Pt({canvas:e,settings:i,states:r})},Bt=({states:e})=>()=>{e.paused=!e.paused,e.paused&&(e.pausedStartTime=e.timestamp)},Rt=({canvas:e,prevSettings:i,resizeCanvas:r})=>s=>{console.log("update() prop is not yet implemented.")},zt=(e,i,r,s,a,d)=>{const h=()=>{if(r.dimensions===void 0&&r.canvas===void 0&&((s.mode==="2d"||s.mode==="webgl")&&({width:i.width,height:i.height}=ne({canvas:e,mode:s.mode,width:window.innerWidth,height:window.innerHeight,pixelRatio:Math.max(s.pixelRatio,1),scaleContext:s.scaleContext})),d(i)),a(i),r.dimensions!==void 0&&s.centered){const _=e.parentElement,n=_.clientWidth,w=_.clientHeight,C=Math.min(1,Math.min((n-50*2)/i.width,(w-50*2)/i.height));e.style.transform=`scale(${C})`}};return{add:()=>{window.addEventListener("resize",h)},remove:()=>{window.removeEventListener("resize",h)},handleResize:h}},$t=(e,i)=>{const r=d=>{d.key===" "?(d.preventDefault(),e.togglePlay()):(d.metaKey||d.ctrlKey)&&!d.shiftKey&&d.key==="s"?(d.preventDefault(),e.exportFrame()):(d.metaKey||d.ctrlKey)&&d.shiftKey&&d.key==="s"?(d.preventDefault(),i.savingFrames?i.captureDone=!0:i.savingFrames=!0):d.key==="t"&&(i.timeResetted=!0)};return{add:()=>{window.addEventListener("keydown",r)},remove:()=>{window.removeEventListener("keydown",r)}}},xt=({settings:e})=>({paused:!1,playMode:"play",savingFrame:!1,savingFrames:!1,captureReady:!1,captureDone:!1,startTime:0,lastStartTime:0,pausedStartTime:0,pausedDuration:0,timestamp:0,lastTimestamp:0,frameInterval:e.playFps!==null?1e3/e.playFps:null,timeResetted:!1}),$=null,W=null,Be=null,Dt=async({canvas:e,settings:i,states:r,props:s})=>{const{framesFormat:a}=i;if(a!=="webm")throw new Error("currently, only webm video format is supported");r.captureDone||Nt({canvas:e,settings:i,states:r,props:s}),r.captureDone&&Ot({canvas:e,settings:i})},At=({canvas:e,settings:i})=>{const{framesFormat:r}=i;if(r!=="webm")throw new Error("currently, only webm video format is supported");$=new Et({target:"buffer",video:{codec:"V_VP9",width:e.width,height:e.height,frameRate:i.exportFps}}),W=new VideoEncoder({output:(s,a)=>$==null?void 0:$.addVideoChunk(s,a),error:s=>console.error(`WebMMuxer error: ${s}`)}),W.configure({codec:"vp09.00.10.08",width:e.width,height:e.height,bitrate:1e7}),Be=-1/0,e.style.outline="3px solid red",e.style.outlineOffset="-3px",console.log(`recording (${r}) started`)},Ot=async({canvas:e,settings:i})=>{const{framesFormat:r}=i;await(W==null?void 0:W.flush());const s=$==null?void 0:$.finalize();Ht(new Blob([s]),i),$=null,W=null,e.style.outline="none",e.style.outlineOffset="0 ",console.log(`recording (${r}) complete`)},Nt=({canvas:e,settings:i,states:r,props:s})=>{const a=new VideoFrame(e,{timestamp:s.time*1e3}),d=s.time-Be>=1e4;d&&(Be=s.time),W==null||W.encode(a,{keyFrame:d}),a.close();const h=Math.floor(i.exportFps*i.duration/1e3);console.log(`%crecording frame... %c${s.frame+1} of ${h}`,"color:black","color:#9aa")},Ht=(e,i)=>{const{filename:r,prefix:s,suffix:a,framesFormat:d}=i,h=window.URL.createObjectURL(e),m=document.createElement("a");m.href=h,m.download=`${lt({filename:r,prefix:s,suffix:a})}.${d}`,m.click(),window.URL.revokeObjectURL(h)},Kt=async(e,i)=>{const r=Tt({main:i}),s=xt({settings:r}),a=await Ut({settings:r,states:s}),{canvas:d}=a,h=e(a);let m=()=>{},b=()=>{};typeof h=="function"?m=h:(m=h.render||m,b=h.resize||b);const{add:F,handleResize:_}=zt(d,a,i,r,m,b),{add:n}=$t(a,s);_();const w=f=>{s.timestamp=f-s.pausedDuration,s.savingFrames?v({canvas:d,settings:r,states:s,props:a}):C({timestamp:f,settings:r,states:s,props:a})};r.animate&&window.requestAnimationFrame(w),r.hotkeys&&(F(),n());const C=({timestamp:f,settings:g,states:y,props:k})=>{if(y.paused){y.pausedDuration=f-y.pausedStartTime,window.requestAnimationFrame(w);return}if(y.timeResetted&&Pe({settings:g,states:y,props:k}),k.time=y.timestamp-y.startTime,k.time>=k.duration&&Pe({settings:g,states:y,props:k}),k.deltaTime=y.timestamp-y.lastTimestamp,y.frameInterval!==null&&k.deltaTime<y.frameInterval){window.requestAnimationFrame(w);return}tt({settings:g,props:k}),Ft({settings:g,states:y,props:k}),it({states:y,props:k}),m(k),window.requestAnimationFrame(w)};let M=0;const v=({canvas:f,settings:g,states:y,props:k})=>{y.captureReady||(Pe({settings:g,states:y,props:k}),At({canvas:f,settings:g}),y.captureReady=!0),k.deltaTime=1e3/g.exportFps,k.time=M*k.deltaTime,tt({settings:g,props:k}),k.frame=M,it({states:y,props:k}),m(k),window.requestAnimationFrame(w),M+=1,k.frame>=g.exportTotalFrames&&(y.captureDone=!0),Dt({canvas:f,settings:g,states:y,props:k}),y.captureDone&&(y.captureReady=!1,y.captureDone=!1,y.savingFrames=!1,y.timeResetted=!0,M=0)}},qt=Kt,L={};Object.defineProperty(L,"__esModule",{value:!0});L.drawSmoothPath=L.drawRect=L.drawPath=L.drawLine=L.drawFillText=Re=L.drawCircle=void 0;const jt=(e,i,r)=>{e.beginPath(),e.arc(i[0],i[1],r*.5,0,Math.PI*2)};var Re=L.drawCircle=jt;const Yt=(e,i,r)=>{e.fillText(i,r[0],r[1])};L.drawFillText=Yt;const Zt=(e,i,r)=>{e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(r[0],r[1])};L.drawLine=Zt;const Gt=(e,i,r=!1)=>{e.beginPath(),e.moveTo(i[0][0],i[0][1]);for(let s=1;s<i.length;s++)e.lineTo(i[s][0],i[s][1]);r&&e.closePath()};L.drawPath=Gt;const Xt=(e,i,r,s="corner")=>{if(e.beginPath(),s==="corner")e.rect(i[0],i[1],r[0],r[1]);else if(s==="center")e.rect(i[0]-r[0]/2,i[1]-r[1]/2,r[0],r[1]);else throw new Error(`drawRect() does not support mode: ${s}`)};L.drawRect=Xt;const Qt=(e,i,r=!1)=>{e.beginPath(),e.moveTo(i[0][0],i[0][1]),e.lineTo(i[1][0],i[1][1]),e.lineTo(i[2][0],i[2][1]);for(let a=3;a<i.length-3;a+=3)e.quadraticCurveTo(i[a][0],i[a][1],i[a+1][0],i[a+1][1]),e.lineTo(i[a+2][0],i[a+2][1]);const s=i[i.length-1];e.lineTo(s[0],s[1]),r&&e.closePath()};L.drawSmoothPath=Qt;var dt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.snapToArray=e.snapBy=e.roundF=e.reflect=e.polarToCartesian=e.modIncl=e.modF=e.mod=e.lerp=e.mix=e.map=e.floorF=e.distSq=e.dist=e.constrain=e.clamp=e.TWO_PI=e.PI=void 0,e.PI=Math.PI,e.TWO_PI=Math.PI*2;const i=(v,f,g)=>Math.min(Math.max(v,f),g);e.clamp=i,e.constrain=e.clamp;const r=(v,f,g,y)=>Math.sqrt((0,e.distSq)(v,f,g,y));e.dist=r;const s=(v,f,g,y)=>(g-v)**2+(y-f)**2;e.distSq=s;const a=(v,f)=>{v=parseFloat(v.toFixed(f));const g=Math.pow(10,f);return Math.floor(v*g)/g};e.floorF=a;const d=(v,f,g,y,k)=>y+(v-f)/(g-f)*(k-y);e.map=d;const h=(v,f,g)=>v*(1-g)+f*g;e.mix=h,e.lerp=e.mix;const m=(v,f)=>(v%f+f)%f;e.mod=m;const b=(v,f,g=6)=>{const y=Math.pow(10,g),k=Math.floor(v*y),Z=Math.floor(f*y);return(k%Z+Z)%Z/y};e.modF=b;const F=(v,f)=>{if(f<0)throw new Error("modIncl(): 2nd arg must be >= 0");return v===f?f:(v%f+f)%f};e.modIncl=F;const _=(v,f)=>[Math.cos(f)*v,Math.sin(f)*v];e.polarToCartesian=_;const n=(v,f)=>f-(v-f);e.reflect=n;const w=(v,f)=>{const g=Math.pow(10,f);return Math.round(v*g)/g};e.roundF=w;const C=(v,f)=>Math.round(v/f)*f;e.snapBy=C;const M=(v,f)=>{if(f.sort((g,y)=>g-y),v<=f[0])return f[0];if(v>=f[f.length-1])return f[f.length-1];for(let g=0;g<f.length-1;g++){const y=f[g],k=f[g+1];if(v>y&&v<k)return Math.abs(v-k)<=Math.abs(v-y)?k:y}throw new Error("snapToArray(): did not meet any condition")};e.snapToArray=M})(dt);var V={},Ue=Math.round,Jt=Math.min,ei=Math.max,ti=Math.ceil,ii=ri;function Y(e,i,r,s){s[0]=Ue(e*255),s[1]=Ue(i*255),s[2]=Ue(r*255)}function at(e,i,r){return ei(i,Jt(e,r))}function ri(e,i,r,s){if(s=s||[0,0,0],e=e%360,i=at(i,0,1),r=at(r,0,1),!i)s[0]=s[1]=s[2]=ti(r*255);else{var a=(1-i)*r,d=r-a,h=e%60;switch(e/60|0){case 0:Y(r,d*e/60+a,a,s);break;case 1:Y(d*(60-h)/60+a,r,a,s);break;case 2:Y(a,r,d*h/60+a,s);break;case 3:Y(a,d*(60-h)/60+a,r,s);break;case 4:Y(d*h/60+a,a,r,s);break;case 5:Y(r,a,d*(60-h)/60+a,s);break}}return s}var We=Math.round,ai=function(e,i,r){var s,a,d,h=Math.max(e,i,r),m=Math.min(e,i,r),b=h-m;return b===0?s=0:e===h?s=(i-r)/b%6:i===h?s=(r-e)/b+2:r===h&&(s=(e-i)/b+4),s=We(s*60),s<0&&(s+=360),a=We((h===0?0:b/h)*100),d=We(h/255*100),[s,a,d]};Object.defineProperty(V,"__esModule",{value:!0});V.hex2rgb=V.rgb2hsv=V.hsb2rgb=ft=V.hsv2rgb=void 0;const ae=ii,ue=ai;function ht(e,i,r,s){if(i!==void 0&&r!==void 0&&s!==void 0)return[...ae(e*360,i,r),s];if(i!==void 0&&r!==void 0)return[...ae(e*360,i,r)];if(i===void 0)if(Array.isArray(e)){const a=[...e];if(a[0]*=360,a.length===3)return[...ae(...a)];if(a.length===4)return[...ae(...a.slice(0,3)),a[3]]}else return[...ae(0,0,e)];throw new Error("hsv2rgb(): doesn't support the type or length of arguments provided")}var ft=V.hsv2rgb=ht;V.hsb2rgb=ht;function ni(e,i,r,s){if(i!==void 0&&r!==void 0&&s!==void 0){const a=ue(e,i,r);return[a[0]/360,a[1]/100,a[2]/100,s]}else if(i!==void 0&&r!==void 0){const a=ue(e,i,r);return[a[0]/360,a[1]/100,a[2]/100]}else if(i===void 0){if(e.length===3){const a=ue(...e);return[a[0]/360,a[1]/100,a[2]/100]}else if(e.length===4){const a=ue(...e.slice(0,3));return[a[0]/360,a[1]/100,a[2]/100,e[3]]}}throw new Error("rgb2hsv(): doesn't support the type or length of arguments provided")}V.rgb2hsv=ni;function si(e){let i;if(e.length===7||e.length===9){if(i=e.substring(1,9).match(/.{2}/g),i)return i.map((r,s)=>{let a=parseInt(r,16);return s===3&&(a/=255),a})}else if((e.length===4||e.length===5)&&(i=e.substring(1,5).match(/.{1}/g),i))return i.map((r,s)=>{let a=parseInt(r+r,16);return s===3&&(a/=255),a});throw new Error("hex2rgb(): doesn't support the length or value of string argument provided")}V.hex2rgb=si;const ze=Math.floor(Math.random()*10+2),oi=({context:e})=>{const i=ze;return({width:r,height:s,playhead:a,totalFrames:d})=>{e.fillStyle="#aaa",e.fillRect(0,0,r,s);const h=Math.min(r,s),m=h*.28;for(let _=0;_<i;_++)e.save(),e.translate(r/2,s/2),e.rotate(_/i*Math.PI*2),Re(e,[m,0],m),e.lineWidth=h*.015,e.strokeStyle="#333",e.stroke(),e.restore();a=dt.snapBy(a,1/d);const b=a*Math.PI*2,F=10;e.save(),e.translate(r/2,s/2),e.rotate(b);for(let _=0;_<F;_++)Re(e,[m,0],m-m*_/F),e.fillStyle=`rgb(${ft(_*.1,1-_*.1,1-_*.1)})`,e.fill();e.restore()}},li={dimensions:[1200,1200],pixelRatio:window.devicePixelRatio,duration:1e3,playFps:ze,exportFps:ze};qt(oi,li);export{kt as _,di as s};
